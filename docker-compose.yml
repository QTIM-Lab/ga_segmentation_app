version: '3.8'

services:
  ga-segmentation-app:
    build: .
    ports:
      - "${PORT}:${PORT}"
    volumes:
      # Mount PACS images directory - ensure the path exists and is accessible
      - ${PACS_DIR}:${PACS_DIR}:ro
      # Mount output directory for persistent annotations
      - ./output:/app/output
      - .:/app
    environment:
      FLASK_ENV: ${FLASK_ENV} # development or production
      BASE_PATH: ${BASE_PATH} # for dev or port forwarding, comment out
      IMAGE_PATHS: ${IMAGE_PATHS}
      PORT: ${PORT}
    command: >
      python app.py --host 0.0.0.0 --port ${PORT} --image-paths ${IMAGE_PATHS}
    restart: unless-stopped
